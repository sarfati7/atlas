---
phase: 07-web-frontend-configuration
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/components/ui/timeline.tsx
  - frontend/src/features/configuration/components/VersionHistory.tsx
  - frontend/src/features/configuration/components/VersionHistoryItem.tsx
autonomous: true

must_haves:
  truths:
    - "Timeline component follows shadcn/ui patterns"
    - "Version history displays date, message, and SHA"
    - "List is scrollable with vertical layout"
  artifacts:
    - path: "frontend/src/components/ui/timeline.tsx"
      provides: "Reusable timeline UI component"
      exports: ["Timeline", "TimelineItem"]
    - path: "frontend/src/features/configuration/components/VersionHistory.tsx"
      provides: "Version history container"
      exports: ["VersionHistory", "VersionHistorySkeleton"]
    - path: "frontend/src/features/configuration/components/VersionHistoryItem.tsx"
      provides: "Single version row"
      exports: ["VersionHistoryItem"]
  key_links:
    - from: "VersionHistory.tsx"
      to: "timeline.tsx"
      via: "import Timeline components"
      pattern: "from '@/components/ui/timeline'"
    - from: "VersionHistoryItem.tsx"
      to: "TimelineItem"
      via: "renders inside TimelineItem"
      pattern: "<TimelineItem"
---

<objective>
Create timeline UI component and version history display for configuration changes.

Purpose: Version history shows users all previous versions of their configuration with date, commit message, and SHA. This component will be used in the History tab of settings.

Output:
- Reusable Timeline UI component (shadcn-style)
- VersionHistory component that fetches and displays versions
- VersionHistoryItem for individual version rows
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-web-frontend-configuration/07-CONTEXT.md

# Existing UI component patterns
@frontend/src/components/ui/card.tsx
@frontend/src/components/ui/skeleton.tsx

# Types and hooks (created in 07-01 or use backend as reference)
@backend/src/atlas/entrypoints/api/routes/configuration.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Timeline UI component</name>
  <files>
    frontend/src/components/ui/timeline.tsx
  </files>
  <action>
Create `frontend/src/components/ui/timeline.tsx` following shadcn/ui patterns:

```typescript
import * as React from 'react'
import { cn } from '@/lib/utils'

interface TimelineProps extends React.HTMLAttributes<HTMLDivElement> {}

export function Timeline({ className, children, ...props }: TimelineProps) {
  return (
    <div className={cn('relative space-y-4 pl-6', className)} {...props}>
      {/* Vertical line connecting timeline items */}
      <div className="absolute left-[9px] top-2 bottom-2 w-px bg-border" />
      {children}
    </div>
  )
}

interface TimelineItemProps extends React.HTMLAttributes<HTMLDivElement> {
  active?: boolean
}

export function TimelineItem({ className, active, children, ...props }: TimelineItemProps) {
  return (
    <div className={cn('relative', className)} {...props}>
      {/* Circle indicator */}
      <div
        className={cn(
          'absolute -left-6 top-1.5 h-3 w-3 rounded-full border-2',
          active
            ? 'border-primary bg-primary'
            : 'border-muted-foreground bg-background'
        )}
      />
      {children}
    </div>
  )
}
```

This component:
- Uses vertical line with absolute positioning
- TimelineItem has circle indicator that can be active (highlighted) or not
- Follows shadcn pattern of accepting className and HTMLAttributes
- Uses cn() utility for class merging
  </action>
  <verify>
`cd frontend && npx tsc --noEmit` passes
File exists at `frontend/src/components/ui/timeline.tsx`
  </verify>
  <done>
Timeline and TimelineItem components with active state styling
  </done>
</task>

<task type="auto">
  <name>Task 2: Create VersionHistoryItem component</name>
  <files>
    frontend/src/features/configuration/components/VersionHistoryItem.tsx
  </files>
  <action>
Create `frontend/src/features/configuration/components/VersionHistoryItem.tsx`:

```typescript
import { formatDistanceToNow } from 'date-fns'
import { TimelineItem } from '@/components/ui/timeline'
import type { Version } from '../types'

interface VersionHistoryItemProps {
  version: Version
  isLatest: boolean
  onSelect?: (version: Version) => void
}

export function VersionHistoryItem({ version, isLatest, onSelect }: VersionHistoryItemProps) {
  return (
    <TimelineItem active={isLatest}>
      <div
        className={`p-3 rounded-lg border bg-card ${onSelect ? 'cursor-pointer hover:bg-accent' : ''}`}
        onClick={() => onSelect?.(version)}
      >
        <div className="flex items-start justify-between gap-4">
          <div className="flex-1 min-w-0">
            <p className="font-medium text-foreground truncate">
              {version.message || 'Configuration update'}
            </p>
            <p className="text-sm text-muted-foreground mt-1">
              {version.author} - {formatDistanceToNow(new Date(version.timestamp), { addSuffix: true })}
            </p>
          </div>
          <code className="text-xs text-muted-foreground font-mono bg-muted px-2 py-1 rounded">
            {version.commit_sha.slice(0, 7)}
          </code>
        </div>
        {isLatest && (
          <span className="inline-flex items-center text-xs text-primary mt-2">
            Current version
          </span>
        )}
      </div>
    </TimelineItem>
  )
}
```

This component:
- Shows commit message (with fallback), author, and relative timestamp
- Displays short SHA as monospace code
- Highlights latest version with "Current version" label
- Supports optional onSelect callback for version selection
  </action>
  <verify>
`cd frontend && npx tsc --noEmit` passes
Component imports TimelineItem correctly
  </verify>
  <done>
Version item shows: message, author, relative time, short SHA
Latest version marked as "Current version"
  </done>
</task>

<task type="auto">
  <name>Task 3: Create VersionHistory container component</name>
  <files>
    frontend/src/features/configuration/components/VersionHistory.tsx
    frontend/src/features/configuration/index.ts
  </files>
  <action>
Create `frontend/src/features/configuration/components/VersionHistory.tsx`:

```typescript
import { History } from 'lucide-react'
import { Timeline } from '@/components/ui/timeline'
import { Skeleton } from '@/components/ui/skeleton'
import { useVersionHistory } from '../hooks/useConfiguration'
import { VersionHistoryItem } from './VersionHistoryItem'
import type { Version } from '../types'

interface VersionHistoryProps {
  onVersionSelect?: (version: Version) => void
}

export function VersionHistory({ onVersionSelect }: VersionHistoryProps) {
  const { data, isLoading, error } = useVersionHistory()

  if (isLoading) {
    return <VersionHistorySkeleton />
  }

  if (error) {
    return (
      <div className="text-center py-12 text-destructive">
        <p>Failed to load version history</p>
      </div>
    )
  }

  if (!data?.versions.length) {
    return (
      <div className="text-center py-12 text-muted-foreground">
        <History className="h-8 w-8 mx-auto mb-2 opacity-50" />
        <p>No version history yet</p>
        <p className="text-sm mt-1">Save your configuration to create the first version</p>
      </div>
    )
  }

  return (
    <Timeline>
      {data.versions.map((version, index) => (
        <VersionHistoryItem
          key={version.commit_sha}
          version={version}
          isLatest={index === 0}
          onSelect={onVersionSelect}
        />
      ))}
    </Timeline>
  )
}

export function VersionHistorySkeleton() {
  return (
    <div className="space-y-4 pl-6">
      {[1, 2, 3].map((i) => (
        <div key={i} className="relative">
          <Skeleton className="absolute -left-6 top-1.5 h-3 w-3 rounded-full" />
          <div className="p-3 rounded-lg border">
            <Skeleton className="h-4 w-3/4 mb-2" />
            <Skeleton className="h-3 w-1/2" />
          </div>
        </div>
      ))}
    </div>
  )
}
```

Update `frontend/src/features/configuration/index.ts` to export new components:

```typescript
export * from './types'
export * from './hooks/useConfiguration'
export { ConfigurationEditor } from './components/ConfigurationEditor'
export { VersionHistory, VersionHistorySkeleton } from './components/VersionHistory'
export { VersionHistoryItem } from './components/VersionHistoryItem'
```
  </action>
  <verify>
`cd frontend && npx tsc --noEmit` passes
VersionHistory uses useVersionHistory hook
Empty state shows helpful message
  </verify>
  <done>
VersionHistory fetches data, handles loading/error/empty states
VersionHistorySkeleton for loading state
All components exported from feature index
  </done>
</task>

</tasks>

<verification>
All components created and exportable:
```bash
cd frontend && npx tsc --noEmit
```

Component structure:
- Timeline is reusable UI component in components/ui/
- VersionHistory and VersionHistoryItem are feature components
- All exports available from `@/features/configuration`
</verification>

<success_criteria>
1. Timeline component renders vertical line with item indicators
2. VersionHistoryItem shows message, author, time, and SHA
3. VersionHistory fetches via useVersionHistory hook
4. Empty state shows helpful message with icon
5. Loading state shows skeleton
6. All components exported from feature index
</success_criteria>

<output>
After completion, create `.planning/phases/07-web-frontend-configuration/07-02-SUMMARY.md`
</output>
